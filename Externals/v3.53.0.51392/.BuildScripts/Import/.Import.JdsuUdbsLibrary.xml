<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- Reference source code, if it exists, and the configuration is -source; 
  Otherwise, reference External binary files -->
  <Choose>
	<When Condition="'$(ReferenceSourceCode)' == 'true' And Exists('..\JdsuUdbsLibrary')">
	  <ItemGroup>
		<ProjectReference Include="..\JdsuUdbsLibrary\JdsuUdbsLibrary.vbproj">
		  <Project>{f82e1a6f-75ed-4e23-becf-e44994527487}</Project>
		  <Name>JdsuUdbsLibrary</Name>
		</ProjectReference>
	  </ItemGroup>
	</When>
		<When Condition="'$(ReferenceSourceCode)' == 'true' And Exists('..\JdsuMeasurementStepsAndProcesses')">
			<ItemGroup>
				<!-- Use the external from the JdsuMeasurementStepsAndProcesses project -->
				<Reference Include="JdsuUdbsLibrary">
					<HintPath>..\JdsuMeasurementStepsAndProcesses\Externals\JdsuUdbsLibrary\$(BinSubfolder)\JdsuUdbsLibrary.dll</HintPath>
				</Reference>
			</ItemGroup>
		</When>
		<When Condition="Exists('Externals\JdsuMeasurementStepsAndProcesses')">
			<ItemGroup>
				<!-- Use the external from the JdsuMeasurementStepsAndProcesses project -->
				<Reference Include="JdsuUdbsLibrary">
					<HintPath>Externals\JdsuMeasurementStepsAndProcesses\$(BinSubfolder)\JdsuUdbsLibrary.dll</HintPath>
				</Reference>
			</ItemGroup>
		</When>
	<Otherwise>
	  <ItemGroup>	  
		<Reference Include="JdsuUdbsLibrary">
		  <!-- UDBS now supports both x86 and x64 -->
		  <HintPath>Externals\JdsuUdbsLibrary\$(BinSubfolder)\JdsuUdbsLibrary.dll</HintPath>
		</Reference>	
	  </ItemGroup>
    </Otherwise>
  </Choose>  
</Project>